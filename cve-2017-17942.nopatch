#
#From 5a4eceed8d2f28d05f49add9ce647684d59d461a Mon Sep 17 00:00:00 2001
#From: erouault <erouault>
#Date: Sun, 14 May 2017 02:26:07 +0000
#Subject: [PATCH] * libtiff/tif_packbits.c: fix out-of-buffer read in
# PackBitsDecode() Fixes
# https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=1563 Credit to OSS-Fuzz
#
#---
# ChangeLog              | 6 ++++++
# libtiff/tif_packbits.c | 6 ++++++
# 2 files changed, 12 insertions(+)
#
#diff --git a/ChangeLog b/ChangeLog
#index 120a80da..28e7be7e 100644
#--- a/ChangeLog
#+++ b/ChangeLog
#@@ -1,3 +1,9 @@
#+2017-05-14 Even Rouault <even.rouault at spatialys.com>
#+
#+	* libtiff/tif_packbits.c: fix out-of-buffer read in PackBitsDecode()
#+	Fixes https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=1563
#+	Credit to OSS-Fuzz
#+
# 2017-05-13 Even Rouault <even.rouault at spatialys.com>
# 
# 	* libtiff/tif_pixarlog.c, tif_luv.c: avoid potential int32
#diff --git a/libtiff/tif_packbits.c b/libtiff/tif_packbits.c
#index fda3208c..d27b1fe9 100644
#--- a/libtiff/tif_packbits.c
#+++ b/libtiff/tif_packbits.c
#@@ -244,6 +244,12 @@ PackBitsDecode(TIFF* tif, uint8* op, tmsize_t occ, uint16 s)
# 				    (unsigned long) ((tmsize_t)n - occ));
# 				n = (long)occ;
# 			}
#+			if( cc == 0 )
#+			{
#+				TIFFWarningExt(tif->tif_clientdata, module,
#+					       "Terminating PackBitsDecode due to lack of data.");
#+				break;
#+			}
# 			occ -= n;
# 			b = *bp++;
# 			cc--;
#-- 
#2.18.0
#
