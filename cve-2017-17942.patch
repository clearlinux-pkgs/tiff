diff --git a/libtiff/tif_packbits.c b/libtiff/tif_packbits.c
index 18904b0..8ebdac2 100644
--- a/libtiff/tif_packbits.c
+++ b/libtiff/tif_packbits.c
@@ -82,7 +82,12 @@ PackBitsEncode(TIFF* tif, uint8* buf, tmsize_t cc, uint16 s)
 		/*
 		 * Find the longest string of identical bytes.
 		 */
-		b = *bp++;
+        if (sizeof(*bp) == sizeof(b)){
+		    b = *bp++;
+        }
+        else{
+            return (-1);
+        }
 		cc--;
 		n = 1;
 		for (; cc > 0 && b == *bp; cc--, bp++)
